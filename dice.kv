#:kivy 1.4.1
#:import copy copy.copy

<DiceHistory>
    canvas:
        Rectangle:
            pos: self.pos
            size: self.size
        
<DiceWidget>
    dice_eqn_input: dice_eqn_input
    dice_output: dice_output
    dice_history: dice_history
    roll_it_btn: roll_it_btn
    dice_io_width: root.width-(root.width/2.5)
    
    # canvas:
    #     Color:
    #         rgb: 0, 0, 0
    #     Rectangle:
    #         pos: self.pos
    #         size: self.size

    FloatLayout:
        canvas:
            Color:
                rgb: 0, 0, 0
            Rectangle:
                pos: root.pos
                size: root.size

        DiceEqnInput:
            id: dice_eqn_input
            font_size: 14
            size_hint: None, None
            size: root.dice_io_width, self.line_height * 1.65
            multiline: False
            pos: 0, root.top - self.height - 1
            text: self.start_text
            on_focus: if self.text==self.start_text: self.text=""
            on_text_validate: root.roll_it()
            true_parent: root

        Button:
            id: roll_it_btn
            size: root.dice_io_width, dice_eqn_input.height
            pos: 0, dice_eqn_input.y - self.height - 1
            text: "Roll It!"
            on_press: root.roll_it()

        TextInput:
            id: dice_output
            font_size: 14
            readonly: True
            size_hint: None, None
            size: root.dice_io_width, root.height - dice_eqn_input.height - 1
            pos: 0, roll_it_btn.y - self.height - 1
            
        ScrollView:
            size_hint: None, None
            size: root.width-(dice_output.width+1), root.height/2.0
            pos: dice_output.right+1, root.top - self.height
            
            AnchorLayout:
                anchor_x: 'center'
                anchor_y: 'top'
                size_hint_y: None
                Bubble:
                    id: dice_history
                    size_hint: (None, None)
                    width: self.parent.width*0.9
                    on_parent: self.height=dice_eqn_input.height
                    arrow_pos: 'left_mid'
                    orientation: 'vertical'            
